"use strict";(globalThis.webpackChunkaicraft_website=globalThis.webpackChunkaicraft_website||[]).push([[713],{3647(e,n,a){a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>_,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"api/tensor","title":"Tensor","description":"#include  and #include","source":"@site/docs/api/tensor.md","sourceDirName":"api","slug":"/api/tensor","permalink":"/Aicraft/docs/api/tensor","draft":false,"unlisted":false,"editUrl":"https://github.com/TobiasTesauri/Aicraft/tree/main/docs/api/tensor.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Tensor"},"sidebar":"docsSidebar","previous":{"title":"API Overview","permalink":"/Aicraft/docs/api/overview"},"next":{"title":"Autograd","permalink":"/Aicraft/docs/api/autograd"}}');var s=a(4848),t=a(8453);const i={sidebar_position:2,title:"Tensor"},c="Tensor API",o={},l=[{value:"Structures",id:"structures",level:2},{value:"<code>ac_shape</code>",id:"ac_shape",level:3},{value:"<code>ac_tensor</code>",id:"ac_tensor",level:3},{value:"Creation",id:"creation",level:2},{value:"Initialization",id:"initialization",level:2},{value:"Operations",id:"operations",level:2},{value:"Arithmetic",id:"arithmetic",level:3},{value:"Reductions",id:"reductions",level:3},{value:"Activations",id:"activations",level:3},{value:"Shape",id:"shape",level:3},{value:"Utilities",id:"utilities",level:2},{value:"PRNG",id:"prng",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"tensor-api",children:"Tensor API"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"#include <aicraft/tensor.h>"})," and ",(0,s.jsx)(n.code,{children:"#include <aicraft/tensor_ops.h>"})]}),"\n",(0,s.jsx)(n.h2,{id:"structures",children:"Structures"}),"\n",(0,s.jsx)(n.h3,{id:"ac_shape",children:(0,s.jsx)(n.code,{children:"ac_shape"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"typedef struct {\r\n    ac_size dims[AC_MAX_DIMS];  // Dimension sizes (max 8D)\r\n    int ndim;                    // Number of dimensions\r\n    ac_size total_size;          // Product of all dims\r\n} ac_shape;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"ac_tensor",children:(0,s.jsx)(n.code,{children:"ac_tensor"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"typedef struct ac_tensor {\r\n    float* data;              // SIMD-aligned float array\r\n    ac_shape shape;           // Tensor dimensions\r\n    float* grad;              // Gradient buffer (NULL if not tracking)\r\n    int requires_grad;        // Whether to track gradients\r\n    ac_op op;                 // Operation that created this tensor\r\n    struct ac_tensor* src[2]; // Input tensors (for autograd)\r\n    void* cache;              // Cached data for backward pass\r\n    int autograd_epoch;       // Epoch for O(1) visited check\r\n} ac_tensor;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"creation",children:"Creation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"// Create N-dimensional tensor (up to 8D)\r\nac_tensor* ac_tensor_alloc(ac_shape shape, int requires_grad);\r\n\r\n// Convenience constructors\r\nac_tensor* ac_tensor_1d(ac_size n, int requires_grad);\r\nac_tensor* ac_tensor_2d(ac_size rows, ac_size cols, int requires_grad);\r\nac_tensor* ac_tensor_3d(ac_size d0, ac_size d1, ac_size d2, int requires_grad);\r\nac_tensor* ac_tensor_4d(ac_size d0, ac_size d1, ac_size d2, ac_size d3, int requires_grad);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"initialization",children:"Initialization"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"ac_tensor_fill(t, 0.0f);                  // Fill with constant\r\nac_tensor_uniform(t, -1.0f, 1.0f);        // Uniform random\r\nac_tensor_xavier(t, fan_in, fan_out);      // Xavier/Glorot init\r\nac_tensor_he(t, fan_in);                   // He/Kaiming init\n"})}),"\n",(0,s.jsx)(n.h2,{id:"operations",children:"Operations"}),"\n",(0,s.jsx)(n.h3,{id:"arithmetic",children:"Arithmetic"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"ac_tensor* ac_tensor_add(ac_tensor* a, ac_tensor* b);      // a + b\r\nac_tensor* ac_tensor_sub(ac_tensor* a, ac_tensor* b);      // a - b\r\nac_tensor* ac_tensor_mul(ac_tensor* a, ac_tensor* b);      // a * b (element-wise)\r\nac_tensor* ac_tensor_div(ac_tensor* a, ac_tensor* b);      // a / b\r\nac_tensor* ac_tensor_scale(ac_tensor* a, float s);          // a * s\r\nac_tensor* ac_tensor_matmul(ac_tensor* a, ac_tensor* b);   // a @ b (matrix multiply)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"reductions",children:"Reductions"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"ac_tensor* ac_tensor_sum(ac_tensor* a);    // Sum all elements \u2192 scalar\r\nac_tensor* ac_tensor_mean(ac_tensor* a);   // Mean of all elements \u2192 scalar\n"})}),"\n",(0,s.jsx)(n.h3,{id:"activations",children:"Activations"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"ac_tensor* ac_tensor_relu(ac_tensor* a);       // max(0, x)\r\nac_tensor* ac_tensor_sigmoid(ac_tensor* a);    // 1 / (1 + exp(-x))\r\nac_tensor* ac_tensor_tanh_act(ac_tensor* a);   // tanh(x)\r\nac_tensor* ac_tensor_softmax(ac_tensor* a);    // exp(x) / sum(exp(x))\n"})}),"\n",(0,s.jsx)(n.h3,{id:"shape",children:"Shape"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"ac_tensor* ac_tensor_reshape(ac_tensor* a, ac_shape new_shape);\r\n// Reshape preserving data (total_size must match)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"utilities",children:"Utilities"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'ac_tensor_print(t, "label");          // Pretty-print tensor\r\nac_shape_eq(a->shape, b->shape);       // Check shape equality\n'})}),"\n",(0,s.jsx)(n.h2,{id:"prng",children:"PRNG"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"// Global xoshiro128** PRNG\r\nfloat ac_random_float(float min, float max);\r\nuint32_t ac_xoshiro128ss(ac_rng* rng);\n"})})]})}function _(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,a){a.d(n,{R:()=>i,x:()=>c});var r=a(6540);const s={},t=r.createContext(s);function i(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);